<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Reports - WiFi Security Educator</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/style.css">
    
    <style>
        .reports-header {
            background: linear-gradient(135deg, #fd7e14 0%, #e8590c 100%);
            color: white;
            padding: 2rem 0;
            border-radius: var(--radius-lg);
            margin-bottom: 2rem;
        }
        
        .report-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-md);
            border-left: 4px solid var(--primary);
            transition: var(--transition-normal);
            cursor: pointer;
        }
        
        .report-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .report-card.critical { border-left-color: #dc3545; }
        .report-card.high { border-left-color: #fd7e14; }
        .report-card.medium { border-left-color: #ffc107; }
        .report-card.low { border-left-color: #198754; }
        
        .report-stats {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            line-height: 1;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .report-preview {
            max-height: 400px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: var(--radius-md);
            padding: 1rem;
            font-family: monospace;
            font-size: 0.875rem;
        }
        
        .export-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .chart-mini {
            height: 80px;
            margin: 1rem 0;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--gray);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .timeline {
            position: relative;
            padding-left: 2rem;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 7px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--light-gray);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 1.5rem;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2rem;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary);
            border: 2px solid white;
            box-shadow: 0 0 0 2px var(--primary);
        }
        
        .print-only {
            display: none;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            .print-only {
                display: block !important;
            }
            
            .report-card {
                break-inside: avoid;
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark no-print">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-shield-alt"></i>
                <span>WiFi Security Educator</span>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">
                            <i class="fas fa-home"></i> Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/dashboard">
                            <i class="fas fa-dashboard"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/scan">
                            <i class="fas fa-wifi"></i> Scan
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/analyze">
                            <i class="fas fa-search"></i> Analyze
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/generate">
                            <i class="fas fa-key"></i> Generate
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/report">
                            <i class="fas fa-file-alt"></i> Reports
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/education">
                            <i class="fas fa-graduation-cap"></i> Learn
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/settings">
                            <i class="fas fa-cog"></i> Settings
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Header -->
        <div class="reports-header no-print">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-5 fw-bold">
                        <i class="fas fa-file-alt"></i> Security Reports
                    </h1>
                    <p class="lead mb-0">
                        View and manage your WiFi security analysis reports
                    </p>
                </div>
                <div class="col-md-4 text-md-end">
                    <button class="btn btn-light me-2" onclick="generateNewReport()">
                        <i class="fas fa-plus me-2"></i>New Report
                    </button>
                    <button class="btn btn-outline-light" onclick="window.print()">
                        <i class="fas fa-print me-2"></i>Print
                    </button>
                </div>
            </div>
        </div>

        <!-- Print Header -->
        <div class="print-only mb-4">
            <h1>WiFi Security Reports</h1>
            <p>Generated: <span id="printDate"></span></p>
            <hr>
        </div>

        <!-- Reports List -->
        <div id="reportsList">
            <!-- Reports will be loaded here -->
            <div class="empty-state">
                <i class="fas fa-file-alt"></i>
                <h4>No Reports Yet</h4>
                <p class="mb-4">Generate your first security report to get started</p>
                <button class="btn btn-primary" onclick="generateNewReport()">
                    <i class="fas fa-plus me-2"></i>Generate First Report
                </button>
            </div>
        </div>

        <!-- Report Details Modal -->
        <div class="modal fade" id="reportDetailsModal" tabindex="-1">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-file-alt me-2"></i>Report Details
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body" id="reportDetailsContent">
                        <!-- Content loaded dynamically -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" onclick="printReport()">
                            <i class="fas fa-print me-2"></i>Print
                        </button>
                        <button type="button" class="btn btn-success" onclick="exportReport()">
                            <i class="fas fa-download me-2"></i>Export
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom JS -->
    <script src="/static/js/app.js"></script>
    
    <script>
        let reports = [];
        let currentReport = null;
        
        document.addEventListener('DOMContentLoaded', function() {
            loadReports();
            document.getElementById('printDate').textContent = new Date().toLocaleString();
            
            // Check for report ID in URL
            const urlParams = new URLSearchParams(window.location.search);
            const reportId = urlParams.get('id');
            if (reportId) {
                viewReport(reportId);
            }
        });
        
        function loadReports() {
            // Try to load from localStorage first
            const savedReports = localStorage.getItem('securityReports');
            if (savedReports) {
                try {
                    reports = JSON.parse(savedReports);
                    displayReports();
                } catch (e) {
                    console.error('Failed to load reports:', e);
                }
            }
            
            // Also try to load from API
            fetch('/api/v1/status')
                .then(response => response.json())
                .then(data => {
                    if (data.reports_count > 0 && reports.length === 0) {
                        // If API has reports but localStorage doesn't, load mock data
                        generateMockReports();
                    }
                });
        }
        
        function generateMockReports() {
            reports = [
                {
                    id: 'rep001',
                    title: 'Monthly Security Audit - January',
                    date: '2024-01-15 14:30:00',
                    type: 'audit',
                    severity: 'medium',
                    summary: {
                        total_networks: 8,
                        secure_networks: 5,
                        risky_networks: 3,
                        vulnerabilities: 12,
                        score: 75
                    },
                    networks: [
                        { ssid: 'Home-Network', security: 'good', encryption: 'WPA2' },
                        { ssid: 'Guest-WiFi', security: 'risky', encryption: 'WPA' },
                        { ssid: 'IoT-Devices', security: 'critical', encryption: 'OPEN' }
                    ]
                },
                {
                    id: 'rep002',
                    title: 'Public WiFi Security Assessment',
                    date: '2024-01-10 09:15:00',
                    type: 'assessment',
                    severity: 'high',
                    summary: {
                        total_networks: 15,
                        secure_networks: 2,
                        risky_networks: 13,
                        vulnerabilities: 28,
                        score: 35
                    },
                    networks: [
                        { ssid: 'CoffeeShop-Free', security: 'critical', encryption: 'OPEN' },
                        { ssid: 'Airport-WiFi', security: 'risky', encryption: 'WEP' },
                        { ssid: 'Hotel-Guest', security: 'medium', encryption: 'WPA' }
                    ]
                },
                {
                    id: 'rep003',
                    title: 'Home Network Optimization',
                    date: '2024-01-05 16:45:00',
                    type: 'optimization',
                    severity: 'low',
                    summary: {
                        total_networks: 3,
                        secure_networks: 3,
                        risky_networks: 0,
                        vulnerabilities: 2,
                        score: 92
                    },
                    networks: [
                        { ssid: 'Main-Home', security: 'excellent', encryption: 'WPA3' },
                        { ssid: 'Smart-Home', security: 'good', encryption: 'WPA2' },
                        { ssid: 'Guest-Access', security: 'good', encryption: 'WPA2' }
                    ]
                }
            ];
            
            localStorage.setItem('securityReports', JSON.stringify(reports));
            displayReports();
        }
        
        function displayReports() {
            const container = document.getElementById('reportsList');
            
            if (reports.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-file-alt"></i>
                        <h4>No Reports Yet</h4>
                        <p class="mb-4">Generate your first security report to get started</p>
                        <button class="btn btn-primary" onclick="generateNewReport()">
                            <i class="fas fa-plus me-2"></i>Generate First Report
                        </button>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="row">';
            
            reports.forEach(report => {
                const severityClass = report.severity || 'medium';
                const severityIcon = severityClass === 'critical' ? 'fa-exclamation-circle' :
                                   severityClass === 'high' ? 'fa-exclamation-triangle' :
                                   severityClass === 'medium' ? 'fa-info-circle' : 'fa-check-circle';
                
                const severityColor = severityClass === 'critical' ? 'danger' :
                                    severityClass === 'high' ? 'warning' :
                                    severityClass === 'medium' ? 'info' : 'success';
                
                html += `
                    <div class="col-lg-6 mb-4">
                        <div class="report-card ${severityClass}" onclick="viewReportDetails('${report.id}')">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h5 class="mb-1">${report.title}</h5>
                                    <small class="text-muted">
                                        <i class="far fa-calendar me-1"></i>${report.date}
                                    </small>
                                </div>
                                <span class="badge bg-${severityColor}">
                                    <i class="fas ${severityIcon} me-1"></i>${severityClass.toUpperCase()}
                                </span>
                            </div>
                            
                            <div class="report-stats">
                                <div class="stat-item">
                                    <div class="stat-value">${report.summary.total_networks}</div>
                                    <div class="stat-label">Networks</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${report.summary.secure_networks}</div>
                                    <div class="stat-label">Secure</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${report.summary.vulnerabilities}</div>
                                    <div class="stat-label">Issues</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${report.summary.score}</div>
                                    <div class="stat-label">Score</div>
                                </div>
                            </div>
                            
                            <div class="chart-mini">
                                <canvas id="chart-${report.id}" height="80"></canvas>
                            </div>
                            
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <small class="text-muted">
                                    ${report.networks.length} networks analyzed
                                </small>
                                <button class="btn btn-sm btn-outline-primary" onclick="event.stopPropagation(); viewReportDetails('${report.id}')">
                                    <i class="fas fa-eye me-1"></i>View
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
            
            // Initialize mini charts
            reports.forEach(report => {
                initMiniChart(report);
            });
        }
        
        function initMiniChart(report) {
            const ctx = document.getElementById(`chart-${report.id}`).getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Secure', 'Risky'],
                    datasets: [{
                        data: [report.summary.secure_networks, report.summary.risky_networks],
                        backgroundColor: ['#198754', '#dc3545'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    cutout: '60%'
                }
            });
        }
        
        function generateNewReport() {
            ReportModule.generateReport();
        }
        
        function viewReportDetails(reportId) {
            const report = reports.find(r => r.id === reportId);
            if (!report) {
                Utils.showNotification('Report not found', 'error');
                return;
            }
            
            currentReport = report;
            
            const modalContent = document.getElementById('reportDetailsContent');
            modalContent.innerHTML = generateReportDetailsHTML(report);
            
            const modal = new bootstrap.Modal(document.getElementById('reportDetailsModal'));
            modal.show();
            
            // Initialize chart in modal
            setTimeout(() => {
                initReportChart(report);
            }, 100);
        }
        
        function generateReportDetailsHTML(report) {
            const severityColor = report.severity === 'critical' ? 'danger' :
                                report.severity === 'high' ? 'warning' :
                                report.severity === 'medium' ? 'info' : 'success';
            
            let networksHtml = '';
            report.networks.forEach(network => {
                const networkColor = network.security === 'excellent' ? 'success' :
                                   network.security === 'good' ? 'info' :
                                   network.security === 'medium' ? 'warning' :
                                   network.security === 'risky' ? 'danger' : 'secondary';
                
                networksHtml += `
                    <tr>
                        <td>${network.ssid}</td>
                        <td>
                            <span class="badge bg-${network.security === 'excellent' ? 'success' : 
                                                  network.security === 'good' ? 'info' : 
                                                  network.security === 'medium' ? 'warning' : 
                                                  network.security === 'risky' ? 'danger' : 'secondary'}">
                                ${network.security.toUpperCase()}
                            </span>
                        </td>
                        <td>${network.encryption}</td>
                        <td>
                            <span class="badge bg-${network.security === 'excellent' ? 'success' : 
                                                  network.security === 'good' ? 'success' : 
                                                  network.security === 'medium' ? 'warning' : 'danger'}">
                                ${network.security === 'excellent' ? '95+' :
                                  network.security === 'good' ? '80-94' :
                                  network.security === 'medium' ? '60-79' :
                                  network.security === 'risky' ? '30-59' : '0-29'}%
                            </span>
                        </td>
                    </tr>
                `;
            });
            
            return `
                <div class="report-details">
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <h4>${report.title}</h4>
                            <div class="d-flex align-items-center gap-3">
                                <span class="badge bg-${severityColor}">
                                    ${report.severity.toUpperCase()} SEVERITY
                                </span>
                                <small class="text-muted">
                                    <i class="far fa-calendar me-1"></i>${report.date}
                                </small>
                                <small class="text-muted">
                                    <i class="fas fa-hashtag me-1"></i>${report.id}
                                </small>
                            </div>
                        </div>
                        <div class="col-md-4 text-md-end">
                            <div class="display-4 fw-bold text-${severityColor}">
                                ${report.summary.score}
                            </div>
                            <small class="text-muted">Overall Security Score</small>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <i class="fas fa-chart-pie me-2"></i>Security Distribution
                                    </h6>
                                    <div style="height: 200px;">
                                        <canvas id="reportMainChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <i class="fas fa-chart-bar me-2"></i>Quick Stats
                                    </h6>
                                    <div class="report-stats">
                                        <div class="stat-item">
                                            <div class="stat-value display-6">${report.summary.total_networks}</div>
                                            <div class="stat-label">Total Networks</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value display-6 text-success">${report.summary.secure_networks}</div>
                                            <div class="stat-label">Secure</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value display-6 text-danger">${report.summary.risky_networks}</div>
                                            <div class="stat-label">Risky</div>
                                        </div>
                                    </div>
                                    <div class="mt-3">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span>Vulnerabilities Found:</span>
                                            <strong>${report.summary.vulnerabilities}</strong>
                                        </div>
                                        <div class="d-flex justify-content-between mb-1">
                                            <span>Encryption Coverage:</span>
                                            <strong>${Math.round((report.summary.secure_networks / report.summary.total_networks) * 100)}%</strong>
                                        </div>
                                        <div class="d-flex justify-content-between">
                                            <span>Report Type:</span>
                                            <strong class="text-capitalize">${report.type}</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <i class="fas fa-network-wired me-2"></i>Analyzed Networks
                                    </h6>
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th>SSID</th>
                                                    <th>Security Level</th>
                                                    <th>Encryption</th>
                                                    <th>Score Range</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${networksHtml}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <i class="fas fa-lightbulb me-2"></i>Recommendations
                                    </h6>
                                    <div class="timeline">
                                        ${generateRecommendations(report)}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Note:</strong> This report is for educational purposes only. 
                                Always consult with security professionals for critical infrastructure.
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function generateRecommendations(report) {
            const recommendations = [
                'Upgrade all WPA networks to WPA3 where supported',
                'Implement network segmentation for IoT devices',
                'Enable MAC address filtering for critical networks',
                'Regularly update router firmware',
                'Disable WPS on all access points',
                'Use strong, unique passwords for each network',
                'Enable network monitoring and logging',
                'Conduct regular security audits'
            ];
            
            let html = '';
            recommendations.forEach((rec, index) => {
                html += `
                    <div class="timeline-item">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex align-items-center">
                                    <span class="badge bg-primary me-3">${index + 1}</span>
                                    <div>${rec}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            return html;
        }
        
        function initReportChart(report) {
            const ctx = document.getElementById('reportMainChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['WPA3', 'WPA2', 'WPA', 'WEP', 'Open'],
                    datasets: [{
                        label: 'Networks',
                        data: [2, 4, 1, 1, 0], // Example data
                        backgroundColor: [
                            '#198754',
                            '#20c997',
                            '#ffc107',
                            '#fd7e14',
                            '#dc3545'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        function printReport() {
            if (!currentReport) return;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>${currentReport.title} - WiFi Security Educator</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #333; }
                        .header { border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
                        .section { margin-bottom: 20px; }
                        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f5f5f5; }
                        .score { font-size: 24px; font-weight: bold; color: #4361ee; }
                        .footer { margin-top: 30px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 12px; color: #666; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>${currentReport.title}</h1>
                        <p><strong>Report ID:</strong> ${currentReport.id}</p>
                        <p><strong>Generated:</strong> ${currentReport.date}</p>
                        <p><strong>Severity:</strong> ${currentReport.severity.toUpperCase()}</p>
                    </div>
                    
                    <div class="section">
                        <h2>Executive Summary</h2>
                        <p>Security Score: <span class="score">${currentReport.summary.score}/100</span></p>
                        <p>Total Networks Analyzed: ${currentReport.summary.total_networks}</p>
                        <p>Secure Networks: ${currentReport.summary.secure_networks}</p>
                        <p>Vulnerabilities Found: ${currentReport.summary.vulnerabilities}</p>
                    </div>
                    
                    <div class="section">
                        <h2>Network Analysis</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>SSID</th>
                                    <th>Security Level</th>
                                    <th>Encryption</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${currentReport.networks.map(net => `
                                    <tr>
                                        <td>${net.ssid}</td>
                                        <td>${net.security.toUpperCase()}</td>
                                        <td>${net.encryption}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="section">
                        <h2>Recommendations</h2>
                        <ol>
                            <li>Upgrade all WPA networks to WPA3 where supported</li>
                            <li>Implement network segmentation for IoT devices</li>
                            <li>Enable MAC address filtering for critical networks</li>
                            <li>Regularly update router firmware</li>
                            <li>Disable WPS on all access points</li>
                        </ol>
                    </div>
                    
                    <div class="footer">
                        <p>Generated by WiFi Security Educator v2.0.0</p>
                        <p><strong>Disclaimer:</strong> This report is for educational purposes only.</p>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        function exportReport() {
            if (!currentReport) {
                Utils.showNotification('No report to export', 'warning');
                return;
            }
            
            const dataStr = JSON.stringify(currentReport, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            const exportFileDefaultName = `security-report-${currentReport.id}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            Utils.showNotification('Report exported successfully', 'success');
        }
        
        function viewReport(reportId) {
            // For direct link access
            viewReportDetails(reportId);
        }
    </script>
</body>
</html>